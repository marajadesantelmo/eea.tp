nivel_educativo= factor(case_when(CH12 %in% 1:3 ~ 'Primario',
CH12 %in% 4:6 & CH13==2 ~ 'Primario',
CH12 %in% 4:6 & CH13==1 ~ 'Secundario',
CH12 %in% 7:8 & CH13==2 ~ 'Secundario',
CH12 %in% 7:8 & CH13==1 ~ 'Universitario'),
levels= c('Primario', 'Secundario', 'Universitario')),
#Realizacion de teletrabajo
teletrabajo=factor(case_when(str_sub(PP04D_COD, start= 3, end =3) == 3 &
(PP04G == 6)~ "teletrabajo",
TRUE~"presencial")),
#Sector
sector = factor (case_when(str_sub(PP04B_COD, start = 1, end = 3) < 04 ~ "agro",
str_sub(PP04B_COD, start = 1, end = 3) > 04 &(str_sub(PP04B_COD, start = 1, end = 3) < 10) ~ "extractivo",
str_sub(PP04B_COD, start = 1, end = 3)> 09 &(str_sub(PP04B_COD, start = 1, end = 3) < 35) ~ "industria_manuf",
str_sub(PP04B_COD, start = 1, end = 3) > 34 &(str_sub(PP04B_COD, start = 1, end = 3) < 40) ~ "ss_publico",
str_sub(PP04B_COD, start = 1, end = 3) == 40 ~ "construcción",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 54) ~ "comercio_y_transporte",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 97) ~ "ss_personales_y_prof",
TRUE ~ "ss_domestico_y_otros"),
levels=c("agro", "extractivo", "industria_manuf",
"ss_publico","construcción", "comercio_y_transporte",
"ss_personales_y_prof", "ss_domestico_y_otros")),
genero= factor(case_when(CH04== 1 ~ "hombre", TRUE~ "mujer"),
levels= c("hombre", 'mujer')),
region = factor(case_when(REGION == 01 ~ "Gran Buenos Aires",
REGION == 40 ~ "NOA",
REGION == 41 ~ "NEA",
REGION == 42 ~ "Cuyo",
REGION == 43 ~ "Pampeana",
REGION == 44 ~ "Patagonia"),
levels= c("Gran Buenos Aires", 'NOA', 'NEA', "Cuyo", "Pampeana", "Patagonia")),
ipcf = factor(case_when(DECCFR > 0 &(DECCFR < 6)  ~ "bajo",
DECCFR > 5 &(DECCFR < 9)  ~ "medio",
DECCFR > 8 &(DECCFR < 5)  ~ "alto"),
levels = c("bajo", "medio", "alto")),
subsidio = factor(case_when(V5_M == 0 ~ "no", TRUE~ "si"),
levels = c("no", "si")),
dependiente_cuidados= case_when(
CH06 < 18 | CH06 > 75   ~ "Dependiente",    #Menores 18 y adultos mayores de 75
TRUE       ~ "No dependiente")) %>%
group_by(CODUSU,NRO_HOGAR) %>%
mutate(qdependientes = sum(dependiente_cuidados=="Dependiente"),
dependientes= case_when(
qdependientes>0 ~ "Hogar con dependientes",
TRUE            ~ "Hogar sin dependientes")) %>%
ungroup()  %>%
select(precariedad, genero, nivel_educativo, rango_etario,
sector, tamanio, complejidad, teletrabajo, subsidio, ipcf, dependientes, PONDERA) # Nos quedamos con las variables que entran para el modelo
df <- readRDS('EPH2019_3.Rds')
df <- df %>%
filter(ESTADO==1 & CAT_OCUP==3) %>%                                 #Filtramos a asalariados ocupados
select(REGION, CH04, CH06, CH12, CH13, PP04D_COD, PP04B_COD, PP07H, #Nos quedamos con las variables que utlizaremos
PP04C, PP04C99, PP04G, V5_M, DECCFR, PONDERA, CODUSU, NRO_HOGAR)
#Generamos variable sobre complejidad del puesto de trabajo 'Baja', 'Media' o 'Alta', utilizando el paquete occupationcross
df <- reclassify_to_isco08(base = df , variable = PP04D_COD, classif_origin = 'CNO2017', add_skill = T)
#La traducimos al español
df <- df %>%
mutate(complejidad= case_when(skill_level=='Low' ~ 'Baja',
skill_level=='Medium' ~ 'Media',
skill_level=='High' ~ 'Alta'))
#Generamos otras variables
df <- df %>%
#Rango Etario
mutate(rango_etario= factor(case_when(CH06 < 25 ~ 'Joven',
CH06 %in% 25:40 ~ 'Joven adulto',
CH06 %in% 41:59 ~ 'Adulto',
CH06 > 59 ~ 'Adulto mayor'),
levels= c('Joven', 'Joven adulto', 'Adulto', 'Adulto mayor')),
#Precariedad laboral (tomando como referencia realización de aportes jubilatorios)
precariedad= factor(case_when(PP07H == 1 ~ "Precario",
PP07H == 2 ~ "No precario"),
levels= c('No precario', 'Precario')),
#Tamaño del establecimiento
tamanio= factor(case_when(PP04C %in% 1:6  |(PP04C %in% 99 & PP04C99 == 1)~ "Pequeño",
PP04C %in% 7:8  ~ "Mediano",
PP04C %in% 9:12 |(PP04C %in% 99 & PP04C99 == 3)~ "Grande"),
levels= c('Pequeño', 'Mediano', 'Grande')),
#Nivel educativo
nivel_educativo= factor(case_when(CH12 %in% 1:3 ~ 'Primario',
CH12 %in% 4:6 & CH13==2 ~ 'Primario',
CH12 %in% 4:6 & CH13==1 ~ 'Secundario',
CH12 %in% 7:8 & CH13==2 ~ 'Secundario',
CH12 %in% 7:8 & CH13==1 ~ 'Universitario'),
levels= c('Primario', 'Secundario', 'Universitario')),
#Realizacion de teletrabajo
teletrabajo=factor(case_when(str_sub(PP04D_COD, start= 3, end =3) == 3 &
(PP04G == 6)~ "teletrabajo",
TRUE~"presencial")),
#Sector
sector = factor (case_when(str_sub(PP04B_COD, start = 1, end = 3) < 04 ~ "agro",
str_sub(PP04B_COD, start = 1, end = 3) > 04 &(str_sub(PP04B_COD, start = 1, end = 3) < 10) ~ "extractivo",
str_sub(PP04B_COD, start = 1, end = 3)> 09 &(str_sub(PP04B_COD, start = 1, end = 3) < 35) ~ "industria_manuf",
str_sub(PP04B_COD, start = 1, end = 3) > 34 &(str_sub(PP04B_COD, start = 1, end = 3) < 40) ~ "ss_publico",
str_sub(PP04B_COD, start = 1, end = 3) == 40 ~ "construcción",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 54) ~ "comercio_y_transporte",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 97) ~ "ss_personales_y_prof",
TRUE ~ "ss_domestico_y_otros"),
levels=c("agro", "extractivo", "industria_manuf",
"ss_publico","construcción", "comercio_y_transporte",
"ss_personales_y_prof", "ss_domestico_y_otros")),
genero= factor(case_when(CH04== 1 ~ "hombre", TRUE~ "mujer"),
levels= c("hombre", 'mujer')),
region = factor(case_when(REGION == 01 ~ "Gran Buenos Aires",
REGION == 40 ~ "NOA",
REGION == 41 ~ "NEA",
REGION == 42 ~ "Cuyo",
REGION == 43 ~ "Pampeana",
REGION == 44 ~ "Patagonia"),
levels= c("Gran Buenos Aires", 'NOA', 'NEA', "Cuyo", "Pampeana", "Patagonia")),
ipcf = factor(case_when(DECCFR > 0 &(DECCFR < 6)  ~ "bajo",
DECCFR > 5 &(DECCFR < 9)  ~ "medio",
DECCFR > 8 &(DECCFR < 5)  ~ "alto"),
levels = c("bajo", "medio", "alto")),
subsidio = factor(case_when(V5_M == 0 ~ "no", TRUE~ "si"),
levels = c("no", "si")),
dependiente_cuidados= case_when(
CH06 < 18 | CH06 > 75   ~ "Dependiente",    #Menores 18 y adultos mayores de 75
TRUE       ~ "No dependiente")) %>%
group_by(CODUSU,NRO_HOGAR) %>%
mutate(qdependientes = sum(dependiente_cuidados=="Dependiente"),
dependientes= case_when(
qdependientes>0 ~ "Hogar con dependientes",
TRUE            ~ "Hogar sin dependientes")) %>%
ungroup()  %>%
select(precariedad, genero, nivel_educativo, rango_etario,
sector, tamanio, complejidad, teletrabajo, subsidio, ipcf, dependientes, PONDERA) # Nos quedamos con las variables que entran para el modelo
View(df)
df <- readRDS('EPH2019_3.Rds')
df <- df %>%
select(REGION, CH04, CH06, CH12, CH13, PP04D_COD, PP04B_COD, PP07H, #Nos quedamos con las variables que utlizaremos
PP04C, PP04C99, PP04G, V5_M, DECCFR,  PONDERA, ESTADO, CAT_OCUP)
#Generamos variable sobre complejidad del puesto de trabajo 'Baja', 'Media' o 'Alta', utilizando el paquete occupationcross
df <- reclassify_to_isco08(base = df , variable = PP04D_COD, classif_origin = 'CNO2017', add_skill = T)
#La traducimos al español
df <- df %>%
mutate(complejidad= case_when(skill_level=='Low' ~ 'Baja',
skill_level=='Medium' ~ 'Media',
skill_level=='High' ~ 'Alta'))
#Generamos otras variables
df <- df %>%
#Rango Etario
mutate(rango_etario= factor(case_when(CH06 < 25 ~ 'Joven',
CH06 %in% 25:40 ~ 'Joven adulto',
CH06 %in% 41:59 ~ 'Adulto',
CH06 > 59 ~ 'Adulto mayor'),
levels= c('Joven', 'Joven adulto', 'Adulto', 'Adulto mayor')),
#Precariedad laboral (tomando como referencia realización de aportes jubilatorios)
precariedad= factor(case_when(PP07H == 1 ~ "Precario",
PP07H == 2 ~ "No precario"),
levels= c('No precario', 'Precario')),
#Tamaño del establecimiento
tamanio= factor(case_when(PP04C %in% 1:6  |(PP04C %in% 99 & PP04C99 == 1)~ "Pequeño",
PP04C %in% 7:8  ~ "Mediano",
PP04C %in% 9:12 |(PP04C %in% 99 & PP04C99 == 3)~ "Grande"),
levels= c('Pequeño', 'Mediano', 'Grande')),
#Nivel educativo
nivel_educativo= factor(case_when(CH12 %in% 1:3 ~ 'Primario',
CH12 %in% 4:6 & CH13==2 ~ 'Primario',
CH12 %in% 4:6 & CH13==1 ~ 'Secundario',
CH12 %in% 7:8 & CH13==2 ~ 'Secundario',
CH12 %in% 7:8 & CH13==1 ~ 'Universitario'),
levels= c('Primario', 'Secundario', 'Universitario')),
teletrabajo=factor(case_when(str_sub(PP04D_COD, start= 3, end =3) == 3 &
(PP04G == 6)~ "teletrabajo",
TRUE~"presencial")),
sector = factor (case_when(str_sub(PP04B_COD, start = 1, end = 3) < 04 ~ "agro",
str_sub(PP04B_COD, start = 1, end = 3) > 04 &(str_sub(PP04B_COD, start = 1, end = 3) < 10) ~ "extractivo",
str_sub(PP04B_COD, start = 1, end = 3)> 09 &(str_sub(PP04B_COD, start = 1, end = 3) < 35) ~ "industria_manuf",
str_sub(PP04B_COD, start = 1, end = 3) > 34 &(str_sub(PP04B_COD, start = 1, end = 3) < 40) ~ "ss_publico",
str_sub(PP04B_COD, start = 1, end = 3) == 40 ~ "construcción",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 54) ~ "comercio_y_transporte",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 97) ~ "ss_personales_y_prof",
TRUE ~ "ss_domestico_y_otros"),
levels=c("agro", "extractivo", "industria_manuf",
"ss_publico","construcción", "comercio_y_transporte",
"ss_personales_y_prof", "ss_domestico_y_otros")),
genero= factor(case_when(CH04== 1 ~ "hombre", TRUE~ "mujer"),
levels= c("hombre", 'mujer')),
region = factor(case_when(REGION == 01 ~ "Gran Buenos Aires",
REGION == 40 ~ "NOA",
REGION == 41 ~ "NEA",
REGION == 42 ~ "Cuyo",
REGION == 43 ~ "Pampeana",
REGION == 44 ~ "Patagonia"),
levels= c("Gran Buenos Aires", 'NOA', 'NEA', "Cuyo", "Pampeana", "Patagonia")),
ipcf = factor(case_when(DECCFR > 0 &(DECCFR < 6)  ~ "bajo",
DECCFR > 5 &(DECCFR < 9)  ~ "medio",
DECCFR > 8 &(DECCFR < 5)  ~ "alto"),
levels = c("bajo", "medio", "alto")),
subsidio = factor(case_when(V5_M == 0 ~ "no", TRUE~ "si"),
levels = c("no", "si")))   %>%
filter(ESTADO==1 & CAT_OCUP==3) %>%      #Filtramos a asalariados ocupados
select(precariedad, genero, nivel_educativo, rango_etario,
sector, tamanio, complejidad, teletrabajo, subsidio, ipcf, PONDERA) # Nos quedamos con las variables que entran para el modelo
View(df)
ls(df)
df <- readRDS('EPH2019_3.Rds')
df <- df %>%
filter(ESTADO==1 & CAT_OCUP==3) %>%                                 #Filtramos a asalariados ocupados
select(REGION, CH04, CH06, CH12, CH13, PP04D_COD, PP04B_COD, PP07H, #Nos quedamos con las variables que utlizaremos
PP04C, PP04C99, PP04G, V5_M, DECCFR, PONDERA, CODUSU, NRO_HOGAR)
#Generamos variable sobre complejidad del puesto de trabajo 'Baja', 'Media' o 'Alta', utilizando el paquete occupationcross
df <- reclassify_to_isco08(base = df , variable = PP04D_COD, classif_origin = 'CNO2017', add_skill = T)
#La traducimos al español
df <- df %>%
mutate(complejidad= case_when(skill_level=='Low' ~ 'Baja',
skill_level=='Medium' ~ 'Media',
skill_level=='High' ~ 'Alta'))
#Generamos otras variables
df <- df %>%
#Rango Etario
mutate(rango_etario= factor(case_when(CH06 < 25 ~ 'Joven',
CH06 %in% 25:40 ~ 'Joven adulto',
CH06 %in% 41:59 ~ 'Adulto',
CH06 > 59 ~ 'Adulto mayor'),
levels= c('Joven', 'Joven adulto', 'Adulto', 'Adulto mayor')),
#Precariedad laboral (tomando como referencia realización de aportes jubilatorios)
precariedad= factor(case_when(PP07H == 1 ~ "Precario",
PP07H == 2 ~ "No precario"),
levels= c('No precario', 'Precario')),
#Tamaño del establecimiento
tamanio= factor(case_when(PP04C %in% 1:6  |(PP04C %in% 99 & PP04C99 == 1)~ "Pequeño",
PP04C %in% 7:8  ~ "Mediano",
PP04C %in% 9:12 |(PP04C %in% 99 & PP04C99 == 3)~ "Grande"),
levels= c('Pequeño', 'Mediano', 'Grande')),
#Nivel educativo
nivel_educativo= factor(case_when(CH12 %in% 1:3 ~ 'Primario',
CH12 %in% 4:6 & CH13==2 ~ 'Primario',
CH12 %in% 4:6 & CH13==1 ~ 'Secundario',
CH12 %in% 7:8 & CH13==2 ~ 'Secundario',
CH12 %in% 7:8 & CH13==1 ~ 'Universitario'),
levels= c('Primario', 'Secundario', 'Universitario')),
#Realizacion de teletrabajo
teletrabajo=factor(case_when(str_sub(PP04D_COD, start= 3, end =3) == 3 &
(PP04G == 6)~ "teletrabajo",
TRUE~"presencial")),
#Sector
sector = factor (case_when(str_sub(PP04B_COD, start = 1, end = 3) < 04 ~ "agro",
str_sub(PP04B_COD, start = 1, end = 3) > 04 &(str_sub(PP04B_COD, start = 1, end = 3) < 10) ~ "extractivo",
str_sub(PP04B_COD, start = 1, end = 3)> 09 &(str_sub(PP04B_COD, start = 1, end = 3) < 35) ~ "industria_manuf",
str_sub(PP04B_COD, start = 1, end = 3) > 34 &(str_sub(PP04B_COD, start = 1, end = 3) < 40) ~ "ss_publico",
str_sub(PP04B_COD, start = 1, end = 3) == 40 ~ "construcción",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 54) ~ "comercio_y_transporte",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 97) ~ "ss_personales_y_prof",
TRUE ~ "ss_domestico_y_otros"),
levels=c("agro", "extractivo", "industria_manuf",
"ss_publico","construcción", "comercio_y_transporte",
"ss_personales_y_prof", "ss_domestico_y_otros")),
genero= factor(case_when(CH04== 1 ~ "hombre", TRUE~ "mujer"),
levels= c("hombre", 'mujer')),
region = factor(case_when(REGION == 01 ~ "Gran Buenos Aires",
REGION == 40 ~ "NOA",
REGION == 41 ~ "NEA",
REGION == 42 ~ "Cuyo",
REGION == 43 ~ "Pampeana",
REGION == 44 ~ "Patagonia"),
levels= c("Gran Buenos Aires", 'NOA', 'NEA', "Cuyo", "Pampeana", "Patagonia")),
ipcf = factor(case_when(DECCFR > 0 &(DECCFR < 6)  ~ "bajo",
DECCFR > 5 &(DECCFR < 9)  ~ "medio",
DECCFR > 8 &(DECCFR < 5)  ~ "alto"),
levels = c("bajo", "medio", "alto")),
subsidio = factor(case_when(V5_M == 0 ~ "no", TRUE~ "si"),
levels = c("no", "si")),
dependiente_cuidados= case_when(
CH06 < 18 | CH06 > 75   ~ "Dependiente",    #Menores 18 y adultos mayores de 75
TRUE       ~ "No dependiente")) %>%
group_by(CODUSU,NRO_HOGAR) %>%
mutate(qdependientes = sum(dependiente_cuidados=="Dependiente"),
dependientes= case_when(
qdependientes>0 ~ "Hogar con dependientes",
TRUE            ~ "Hogar sin dependientes")) %>%
ungroup()  %>%
select(precariedad, genero, nivel_educativo, rango_etario,
sector, tamanio, complejidad, teletrabajo, subsidio, ipcf, dependientes, PONDERA) # Nos quedamos con las variables que entran para el modelo
View(df)
table(df$rango_etario, df$dependientes)
options(scipen = 99)
library(tidyverse)
library(eph)
#devtools::install_github("Guidowe/occupationcross")
library(occupationcross)
library(GGally)
library(broom)
library(purrr)
library(stringr)
library(data.table)
library(pROC)
#Descargamos la base
df <- get_microdata(year=2019, trimester=3, type='individual')
#La etiquetamos de forma automática con el comando del paquete eph
df <- organize_labels(df=df, type='individual')
#La guardo para no tener que estar bajándola todo el tiempo
saveRDS(df, 'EPH2019_3.Rds')
df <- readRDS('EPH2019_3.Rds')
df <- df %>%
select(REGION, CH04, CH06, CH12, CH13, PP04D_COD, PP04B_COD, PP07H, #Nos quedamos con las variables que utlizaremos
PP04C, PP04C99, PP04G, V5_M, DECCFR, CODUSU, NRO_HOGAR, PONDERA)
#Generamos variable sobre complejidad del puesto de trabajo 'Baja', 'Media' o 'Alta', utilizando el paquete occupationcross
df <- reclassify_to_isco08(base = df , variable = PP04D_COD, classif_origin = 'CNO2017', add_skill = T)
#La traducimos al español
df <- df %>%
mutate(complejidad= case_when(skill_level=='Low' ~ 'Baja',
skill_level=='Medium' ~ 'Media',
skill_level=='High' ~ 'Alta'))
#Generamos otras variables
df <- df %>%
#Rango Etario
mutate(rango_etario= factor(case_when(CH06 < 25 ~ 'Joven',
CH06 %in% 25:40 ~ 'Joven adulto',
CH06 %in% 41:59 ~ 'Adulto',
CH06 > 59 ~ 'Adulto mayor'),
levels= c('Joven', 'Joven adulto', 'Adulto', 'Adulto mayor')),
#Precariedad laboral (tomando como referencia realización de aportes jubilatorios)
precariedad= factor(case_when(PP07H == 1 ~ "Precario",
PP07H == 2 ~ "No precario"),
levels= c('No precario', 'Precario')),
#Tamaño del establecimiento
tamanio= factor(case_when(PP04C %in% 1:6  |(PP04C %in% 99 & PP04C99 == 1)~ "Pequeño",
PP04C %in% 7:8  ~ "Mediano",
PP04C %in% 9:12 |(PP04C %in% 99 & PP04C99 == 3)~ "Grande"),
levels= c('Pequeño', 'Mediano', 'Grande')),
#Nivel educativo
nivel_educativo= factor(case_when(CH12 %in% 1:3 ~ 'Primario',
CH12 %in% 4:6 & CH13==2 ~ 'Primario',
CH12 %in% 4:6 & CH13==1 ~ 'Secundario',
CH12 %in% 7:8 & CH13==2 ~ 'Secundario',
CH12 %in% 7:8 & CH13==1 ~ 'Universitario'),
levels= c('Primario', 'Secundario', 'Universitario')),
teletrabajo=factor(case_when(str_sub(PP04D_COD, start= 3, end =3) == 3 &
(PP04G == 6)~ "teletrabajo",
TRUE~"presencial")),
sector = factor (case_when(str_sub(PP04B_COD, start = 1, end = 3) < 04 ~ "agro",
str_sub(PP04B_COD, start = 1, end = 3) > 04 &(str_sub(PP04B_COD, start = 1, end = 3) < 10) ~ "extractivo",
str_sub(PP04B_COD, start = 1, end = 3)> 09 &(str_sub(PP04B_COD, start = 1, end = 3) < 35) ~ "industria_manuf",
str_sub(PP04B_COD, start = 1, end = 3) > 34 &(str_sub(PP04B_COD, start = 1, end = 3) < 40) ~ "ss_publico",
str_sub(PP04B_COD, start = 1, end = 3) == 40 ~ "construcción",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 54) ~ "comercio_y_transporte",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 97) ~ "ss_personales_y_prof",
TRUE ~ "ss_domestico_y_otros"),
levels=c("agro", "extractivo", "industria_manuf",
"ss_publico","construcción", "comercio_y_transporte",
"ss_personales_y_prof", "ss_domestico_y_otros")),
genero= factor(case_when(CH04== 1 ~ "hombre", TRUE~ "mujer"),
levels= c("hombre", 'mujer')),
region = factor(case_when(REGION == 01 ~ "Gran Buenos Aires",
REGION == 40 ~ "NOA",
REGION == 41 ~ "NEA",
REGION == 42 ~ "Cuyo",
REGION == 43 ~ "Pampeana",
REGION == 44 ~ "Patagonia"),
levels= c("Gran Buenos Aires", 'NOA', 'NEA', "Cuyo", "Pampeana", "Patagonia")),
ipcf = factor(case_when(DECCFR > 0 &(DECCFR < 6)  ~ "bajo",
DECCFR > 5 &(DECCFR < 9)  ~ "medio",
DECCFR > 8 &(DECCFR < 5)  ~ "alto"),
levels = c("bajo", "medio", "alto")),
subsidio = factor(case_when(V5_M == 0 ~ "no", TRUE~ "si"),
levels = c("no", "si")),
dependiente_cuidados= case_when(
CH06 < 18 | CH06 > 75   ~ "Dependiente",    #Menores 18 y adultos mayores de 75
TRUE       ~ "No dependiente")) %>%
group_by(CODUSU,NRO_HOGAR) %>%
mutate(qdependientes = sum(dependiente_cuidados=="Dependiente"),
dependientes= case_when(
qdependientes>0 ~ "Hogar con dependientes",
TRUE            ~ "Hogar sin dependientes")) %>%
ungroup()  %>%
filter(ESTADO==1 & CAT_OCUP==3) %>%                                 #Filtramos a asalariados ocupados
select(precariedad, genero, nivel_educativo, rango_etario,
sector, tamanio, complejidad, teletrabajo, subsidio, ipcf, dependientes, PONDERA) # Nos quedamos con las variables que entran para el modelo
#Generamos otras variables
df <- df %>%
#Rango Etario
mutate(rango_etario= factor(case_when(CH06 < 25 ~ 'Joven',
CH06 %in% 25:40 ~ 'Joven adulto',
CH06 %in% 41:59 ~ 'Adulto',
CH06 > 59 ~ 'Adulto mayor'),
levels= c('Joven', 'Joven adulto', 'Adulto', 'Adulto mayor')),
#Precariedad laboral (tomando como referencia realización de aportes jubilatorios)
precariedad= factor(case_when(PP07H == 1 ~ "Precario",
PP07H == 2 ~ "No precario"),
levels= c('No precario', 'Precario')),
#Tamaño del establecimiento
tamanio= factor(case_when(PP04C %in% 1:6  |(PP04C %in% 99 & PP04C99 == 1)~ "Pequeño",
PP04C %in% 7:8  ~ "Mediano",
PP04C %in% 9:12 |(PP04C %in% 99 & PP04C99 == 3)~ "Grande"),
levels= c('Pequeño', 'Mediano', 'Grande')),
#Nivel educativo
nivel_educativo= factor(case_when(CH12 %in% 1:3 ~ 'Primario',
CH12 %in% 4:6 & CH13==2 ~ 'Primario',
CH12 %in% 4:6 & CH13==1 ~ 'Secundario',
CH12 %in% 7:8 & CH13==2 ~ 'Secundario',
CH12 %in% 7:8 & CH13==1 ~ 'Universitario'),
levels= c('Primario', 'Secundario', 'Universitario')),
teletrabajo=factor(case_when(str_sub(PP04D_COD, start= 3, end =3) == 3 &
(PP04G == 6)~ "teletrabajo",
TRUE~"presencial")),
sector = factor (case_when(str_sub(PP04B_COD, start = 1, end = 3) < 04 ~ "agro",
str_sub(PP04B_COD, start = 1, end = 3) > 04 &(str_sub(PP04B_COD, start = 1, end = 3) < 10) ~ "extractivo",
str_sub(PP04B_COD, start = 1, end = 3)> 09 &(str_sub(PP04B_COD, start = 1, end = 3) < 35) ~ "industria_manuf",
str_sub(PP04B_COD, start = 1, end = 3) > 34 &(str_sub(PP04B_COD, start = 1, end = 3) < 40) ~ "ss_publico",
str_sub(PP04B_COD, start = 1, end = 3) == 40 ~ "construcción",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 54) ~ "comercio_y_transporte",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 97) ~ "ss_personales_y_prof",
TRUE ~ "ss_domestico_y_otros"),
levels=c("agro", "extractivo", "industria_manuf",
"ss_publico","construcción", "comercio_y_transporte",
"ss_personales_y_prof", "ss_domestico_y_otros")),
genero= factor(case_when(CH04== 1 ~ "hombre", TRUE~ "mujer"),
levels= c("hombre", 'mujer')),
region = factor(case_when(REGION == 01 ~ "Gran Buenos Aires",
REGION == 40 ~ "NOA",
REGION == 41 ~ "NEA",
REGION == 42 ~ "Cuyo",
REGION == 43 ~ "Pampeana",
REGION == 44 ~ "Patagonia"),
levels= c("Gran Buenos Aires", 'NOA', 'NEA', "Cuyo", "Pampeana", "Patagonia")),
ipcf = factor(case_when(DECCFR > 0 &(DECCFR < 6)  ~ "bajo",
DECCFR > 5 &(DECCFR < 9)  ~ "medio",
DECCFR > 8 &(DECCFR < 5)  ~ "alto"),
levels = c("bajo", "medio", "alto")),
subsidio = factor(case_when(V5_M == 0 ~ "no", TRUE~ "si"),
levels = c("no", "si")),
dependiente_cuidados= case_when(
CH06 < 18 | CH06 > 75   ~ "Dependiente",    #Menores 18 y adultos mayores de 75
TRUE       ~ "No dependiente")) %>%
group_by(CODUSU,NRO_HOGAR) %>%
mutate(qdependientes = sum(dependiente_cuidados=="Dependiente"),
dependientes= case_when(
qdependientes>0 ~ "Hogar con dependientes",
TRUE            ~ "Hogar sin dependientes")) %>%
ungroup()  %>%
filter(ESTADO==1 & CAT_OCUP==3) %>%                                 #Filtramos a asalariados ocupados
select(precariedad, genero, nivel_educativo, rango_etario,
sector, tamanio, complejidad, teletrabajo, subsidio, ipcf, dependientes, PONDERA) # Nos quedamos con las variables que entran para el modelo
df <- readRDS('EPH2019_3.Rds')
df <- df %>%
select(ESTADO, CAT_OCUP, REGION, CH04, CH06, CH12, CH13, PP04D_COD, PP04B_COD, PP07H, #Nos quedamos con las variables que utlizaremos
PP04C, PP04C99, PP04G, V5_M, DECCFR, CODUSU, NRO_HOGAR, PONDERA)
#Generamos variable sobre complejidad del puesto de trabajo 'Baja', 'Media' o 'Alta', utilizando el paquete occupationcross
df <- reclassify_to_isco08(base = df , variable = PP04D_COD, classif_origin = 'CNO2017', add_skill = T)
#La traducimos al español
df <- df %>%
mutate(complejidad= case_when(skill_level=='Low' ~ 'Baja',
skill_level=='Medium' ~ 'Media',
skill_level=='High' ~ 'Alta'))
#Generamos otras variables
df <- df %>%
#Rango Etario
mutate(rango_etario= factor(case_when(CH06 < 25 ~ 'Joven',
CH06 %in% 25:40 ~ 'Joven adulto',
CH06 %in% 41:59 ~ 'Adulto',
CH06 > 59 ~ 'Adulto mayor'),
levels= c('Joven', 'Joven adulto', 'Adulto', 'Adulto mayor')),
#Precariedad laboral (tomando como referencia realización de aportes jubilatorios)
precariedad= factor(case_when(PP07H == 1 ~ "Precario",
PP07H == 2 ~ "No precario"),
levels= c('No precario', 'Precario')),
#Tamaño del establecimiento
tamanio= factor(case_when(PP04C %in% 1:6  |(PP04C %in% 99 & PP04C99 == 1)~ "Pequeño",
PP04C %in% 7:8  ~ "Mediano",
PP04C %in% 9:12 |(PP04C %in% 99 & PP04C99 == 3)~ "Grande"),
levels= c('Pequeño', 'Mediano', 'Grande')),
#Nivel educativo
nivel_educativo= factor(case_when(CH12 %in% 1:3 ~ 'Primario',
CH12 %in% 4:6 & CH13==2 ~ 'Primario',
CH12 %in% 4:6 & CH13==1 ~ 'Secundario',
CH12 %in% 7:8 & CH13==2 ~ 'Secundario',
CH12 %in% 7:8 & CH13==1 ~ 'Universitario'),
levels= c('Primario', 'Secundario', 'Universitario')),
teletrabajo=factor(case_when(str_sub(PP04D_COD, start= 3, end =3) == 3 &
(PP04G == 6)~ "teletrabajo",
TRUE~"presencial")),
sector = factor (case_when(str_sub(PP04B_COD, start = 1, end = 3) < 04 ~ "agro",
str_sub(PP04B_COD, start = 1, end = 3) > 04 &(str_sub(PP04B_COD, start = 1, end = 3) < 10) ~ "extractivo",
str_sub(PP04B_COD, start = 1, end = 3)> 09 &(str_sub(PP04B_COD, start = 1, end = 3) < 35) ~ "industria_manuf",
str_sub(PP04B_COD, start = 1, end = 3) > 34 &(str_sub(PP04B_COD, start = 1, end = 3) < 40) ~ "ss_publico",
str_sub(PP04B_COD, start = 1, end = 3) == 40 ~ "construcción",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 54) ~ "comercio_y_transporte",
str_sub(PP04B_COD, start = 1, end = 3) > 44 &(str_sub(PP04B_COD, start = 1, end = 3) < 97) ~ "ss_personales_y_prof",
TRUE ~ "ss_domestico_y_otros"),
levels=c("agro", "extractivo", "industria_manuf",
"ss_publico","construcción", "comercio_y_transporte",
"ss_personales_y_prof", "ss_domestico_y_otros")),
genero= factor(case_when(CH04== 1 ~ "hombre", TRUE~ "mujer"),
levels= c("hombre", 'mujer')),
region = factor(case_when(REGION == 01 ~ "Gran Buenos Aires",
REGION == 40 ~ "NOA",
REGION == 41 ~ "NEA",
REGION == 42 ~ "Cuyo",
REGION == 43 ~ "Pampeana",
REGION == 44 ~ "Patagonia"),
levels= c("Gran Buenos Aires", 'NOA', 'NEA', "Cuyo", "Pampeana", "Patagonia")),
ipcf = factor(case_when(DECCFR > 0 &(DECCFR < 6)  ~ "bajo",
DECCFR > 5 &(DECCFR < 9)  ~ "medio",
DECCFR > 8 &(DECCFR < 5)  ~ "alto"),
levels = c("bajo", "medio", "alto")),
subsidio = factor(case_when(V5_M == 0 ~ "no", TRUE~ "si"),
levels = c("no", "si")),
dependiente_cuidados= case_when(
CH06 < 18 | CH06 > 75   ~ "Dependiente",    #Menores 18 y adultos mayores de 75
TRUE       ~ "No dependiente")) %>%
group_by(CODUSU,NRO_HOGAR) %>%
mutate(qdependientes = sum(dependiente_cuidados=="Dependiente"),
dependientes= case_when(
qdependientes>0 ~ "Hogar con dependientes",
TRUE            ~ "Hogar sin dependientes")) %>%
ungroup()  %>%
filter(ESTADO==1 & CAT_OCUP==3) %>%                                 #Filtramos a asalariados ocupados
select(precariedad, genero, nivel_educativo, rango_etario,
sector, tamanio, complejidad, teletrabajo, subsidio, ipcf, dependientes, PONDERA) # Nos quedamos con las variables que entran para el modelo
View(df)
table(df$rango_etario, df$dependientes)
